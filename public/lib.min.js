function $f3ad94c9f84f4d57$export$a6cdc56e425d0d0a(x) {
    return x && typeof x == "object";
}
function $f3ad94c9f84f4d57$export$8ca3e64ec0f98f12(x) {
    return typeof x == "function";
}
function $f3ad94c9f84f4d57$export$53b83ca8eaab0383(x) {
    return $f3ad94c9f84f4d57$export$a6cdc56e425d0d0a(x) && (x.constructor == Object || x.constructor == undefined);
}
function $f3ad94c9f84f4d57$export$8793edee2d425525() {
// Does nothing
}
function $f3ad94c9f84f4d57$export$45b10814cc054894(x) {
    if (Array.isArray(x)) return x;
    if (!x) return [];
    return [
        x
    ];
}
const $f3ad94c9f84f4d57$export$7e674a85a2656dce = "a abbr address area article aside audio b base bdi bdo blockquote body br button canvas caption cite code col colgroup data datalist dd del details dfn dialog div dl dt em embed fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 head header hgroup hr html i iframe img input ins kbd label legend li link main map mark menu meta meter nav noscript object ol optgroup option output p picture pre progress q rp rt ruby s samp script section select slot small source span strong style sub summary sup table tbody td template textarea tfoot th thead time title tr track u ul var video wbr".split(" ");
const $f3ad94c9f84f4d57$export$7f7c530a82f07f20 = "area base br col embed hr img input link meta source track wbr".split(" ");
const $f3ad94c9f84f4d57$export$d656c518efb211c0 = "push pop shift unshift splice sort reverse fill copyWithin".split(" ");


Object.assign($4afa49a6779c8690$export$69fef04fa539b17a, {
    GET: 1,
    SET: 2,
    DEF: 4,
    DEL: 8,
    CALL: 16,
    ALL: 31,
    OPS: [
        1,
        2,
        4,
        8,
        16
    ],
    /**
   * Subscribe
   * @param {Function} fn callback that will receive operation, path and payload
   * @param {object|number} operations
   */ sub (fn, operations = $4afa49a6779c8690$export$69fef04fa539b17a.ALL) {
        $4afa49a6779c8690$var$subs.add(fn, operations);
    },
    /**
   * Unsubscribe
   * @param {Function} fn
   */ unsub (fn) {
        $4afa49a6779c8690$var$subs.delete(fn);
    }
});
const $4afa49a6779c8690$var$subs = new class {
    constructor(){
        $4afa49a6779c8690$export$69fef04fa539b17a.OPS.map((op)=>this[op] = new Set());
    }
    /**
   * Add handler.
   * @param {VoidFunction} fn the handler
   * @param {number} ops bitmask of values in Reactive.OPS
   * @void
   */ add(fn, ops) {
        $4afa49a6779c8690$export$69fef04fa539b17a.OPS.forEach((op)=>ops & op && this[op].add(fn));
    }
    /**
   * Delete handler.
   * @param {VoidFunction} fn the handler
   * @void
   */ delete(fn) {
        $4afa49a6779c8690$export$69fef04fa539b17a.OPS.forEach((op)=>this[op].delete(fn));
    }
    /**
   * Run subscribed handlers.
   * @param {number} op one of values in Reactive.OPS
   * @param {string} ptr global JSON pointer
   * @param {any} payload data specific for the operation
   */ run(op, ptr, payload) {
        this[op].forEach((fn)=>fn(op, ptr, payload));
    }
}();
/**
 * Special properties
 */ const $4afa49a6779c8690$var$IS_PROXY = Symbol(), $4afa49a6779c8690$var$JSON_PTR = Symbol();
const $4afa49a6779c8690$export$9d46b30cec5278e7 = {
    unescape (x) {
        return x.replaceAll("~1", "/").replaceAll("~0", "~");
    },
    escape (x) {
        return x.replaceAll("~", "~0").replaceAll("/", "~1");
    },
    /**
   * Append a key name to the JSON pointer
   * @param {string} ptr
   * @param {string} key
   * @return {string}
   */ append (ptr, key) {
        return ptr + "/" + $4afa49a6779c8690$export$9d46b30cec5278e7.escape(key);
    },
    /**
   * Get the name of property pointer points to
   * @param {string} ptr
   * @return {string}
   */ propName (ptr) {
        return $4afa49a6779c8690$export$9d46b30cec5278e7.unescape(ptr.split("/").pop());
    },
    /**
   * Get JSON pointer of the object or method
   * @param {object|function} obj
   * @return {string?}
   */ of (obj) {
        if (!(0, $f3ad94c9f84f4d57$export$a6cdc56e425d0d0a)(obj) && !(0, $f3ad94c9f84f4d57$export$8ca3e64ec0f98f12)(obj)) return;
        if (!obj[$4afa49a6779c8690$var$IS_PROXY]) return;
        return obj[$4afa49a6779c8690$var$JSON_PTR];
    }
};
function $4afa49a6779c8690$var$proxyTraps(path) {
    return {
        get: (object, key)=>{
            if (key == $4afa49a6779c8690$var$IS_PROXY) return true;
            if (key == $4afa49a6779c8690$var$JSON_PTR) return path;
            const ptr = $4afa49a6779c8690$export$9d46b30cec5278e7.append(path, key);
            $4afa49a6779c8690$var$subs.run($4afa49a6779c8690$export$69fef04fa539b17a.GET, ptr);
            if ((0, $f3ad94c9f84f4d57$export$a6cdc56e425d0d0a)(object[key]) && !object[key][$4afa49a6779c8690$var$IS_PROXY]) object[key] = new Proxy(object[key], $4afa49a6779c8690$var$proxyTraps(ptr));
            if ((0, $f3ad94c9f84f4d57$export$8ca3e64ec0f98f12)(object[key]) && !object[key][$4afa49a6779c8690$var$IS_PROXY]) object[key] = new Proxy(object[key], {
                get: (fn, key)=>{
                    if (key == $4afa49a6779c8690$var$IS_PROXY) return true;
                    if (key == $4afa49a6779c8690$var$JSON_PTR) return ptr;
                    return fn[key];
                },
                apply (fn, $this, args) {
                    $4afa49a6779c8690$var$subs.run($4afa49a6779c8690$export$69fef04fa539b17a.CALL, ptr, args);
                    return fn.apply($this, args);
                }
            });
            return object[key];
        },
        set: (object, key, value)=>{
            if (object[key] !== value) {
                $4afa49a6779c8690$var$subs.run($4afa49a6779c8690$export$69fef04fa539b17a.SET, $4afa49a6779c8690$export$9d46b30cec5278e7.append(path, key), value);
                object[key] = value;
            }
            return true;
        },
        defineProperty: (object, key, attrs)=>{
            $4afa49a6779c8690$var$subs.run($4afa49a6779c8690$export$69fef04fa539b17a.DEF, $4afa49a6779c8690$export$9d46b30cec5278e7.append(path, key), attrs);
            Object.defineProperty(object, key, attrs);
            return true;
        },
        deleteProperty: (object, key)=>{
            $4afa49a6779c8690$var$subs.run($4afa49a6779c8690$export$69fef04fa539b17a.DEL, $4afa49a6779c8690$export$9d46b30cec5278e7.append(path, key));
            delete object[key];
            return true;
        }
    };
}
/**
 * The reactive object
 */ let $4afa49a6779c8690$var$nextId = 0;
function $4afa49a6779c8690$export$69fef04fa539b17a(value, name = "") {
    return new Proxy((0, $f3ad94c9f84f4d57$export$a6cdc56e425d0d0a)(value) ? value : {
        value: value
    }, $4afa49a6779c8690$var$proxyTraps("/$" + name + ($4afa49a6779c8690$var$nextId++).toString(36)));
}


class $5be6f8944b1012f0$export$6dda3d0957802b97 {
    constructor(fn, opts){
        this.deps = new Set();
        this.fn = fn;
        this.timeout = null;
        this.collect = (_, ptr)=>this.deps.add(ptr);
        this.rerun = (_, ptr)=>{
            if (this.deps.has(ptr)) {
                if (opts.async) {
                    if (this.timeout) clearTimeout(this.timeout);
                    this.timeout = setTimeout(()=>this.run());
                } else this.run();
            }
        };
        if (opts.immediate) this.run();
    }
    run() {
        if (this.timeout) {
            clearTimeout(this.timeout);
            this.timeout = null;
        }
        this.deps.clear();
        (0, $4afa49a6779c8690$export$69fef04fa539b17a).sub(this.collect, (0, $4afa49a6779c8690$export$69fef04fa539b17a).GET);
        this.fn();
        (0, $4afa49a6779c8690$export$69fef04fa539b17a).unsub(this.collect);
        (0, $4afa49a6779c8690$export$69fef04fa539b17a).sub(this.rerun, (0, $4afa49a6779c8690$export$69fef04fa539b17a).ALL - (0, $4afa49a6779c8690$export$69fef04fa539b17a).GET);
    }
    stop() {
        (0, $4afa49a6779c8690$export$69fef04fa539b17a).unsub(this.rerun);
        if (this.timeout) clearTimeout(this.timeout);
    }
}





const $15814c427c76c40c$var$renderStack = [];
$15814c427c76c40c$var$renderStack.top = function() {
    return this[this.length - 1];
};
function $15814c427c76c40c$var$isChild(x) {
    return [
        "string",
        "number",
        "function"
    ].includes(typeof x) || x instanceof Node || x instanceof $15814c427c76c40c$export$16fa2f45be04daa8;
}
function $15814c427c76c40c$export$c8a8987d4410bf2d(tagName, attributes = {}, ...children) {
    // Function called as createElement(tagName, ...children);
    if ($15814c427c76c40c$var$isChild(attributes)) {
        children.unshift(attributes);
        attributes = {};
    }
    const el = document.createElement(tagName);
    for(const attrName in attributes){
        const attrValue = attributes[attrName];
        if (typeof attrValue == "function") {
            if (attrName.startsWith("on")) el.addEventListener(attrName.substring(2), attrValue);
            else $15814c427c76c40c$var$renderStack.top().computations.add(new (0, $5be6f8944b1012f0$export$6dda3d0957802b97)(()=>{
                const v = attrValue();
                if (typeof v == "boolean" || v == null) {
                    if (v) el.setAttribute(attrName, "true");
                    else el.removeAttribute(attrName);
                } else el.setAttribute(attrName, v);
            }, {
                async: true,
                immediate: true
            }));
        } else el.setAttribute(attrName, attrValue);
    }
    if ((0, $f3ad94c9f84f4d57$export$7f7c530a82f07f20).includes(tagName)) return el;
    for (const child of children.flat()){
        if (child instanceof $15814c427c76c40c$export$16fa2f45be04daa8) {
            const pivotNode = document.createComment("");
            el.appendChild(pivotNode);
            $15814c427c76c40c$var$renderStack.top().components.set(pivotNode, child);
            child.mount(pivotNode);
        } else if (child instanceof Node) el.appendChild(child);
        else el.appendChild($15814c427c76c40c$export$b2ce9ad90858ed7a(child));
    }
    return el;
}
function $15814c427c76c40c$export$49993a8b66444073(obj) {
    for (let t of (0, $f3ad94c9f84f4d57$export$7e674a85a2656dce))obj[t] = $15814c427c76c40c$export$c8a8987d4410bf2d.bind(null, t);
}
function $15814c427c76c40c$export$b2ce9ad90858ed7a(content) {
    if (typeof content == "function") {
        let textNode = document.createTextNode("");
        $15814c427c76c40c$var$renderStack.top().computations.add(new (0, $5be6f8944b1012f0$export$6dda3d0957802b97)(()=>textNode.textContent = String(content()), {
            async: true,
            immediate: true
        }));
        return textNode;
    } else return document.createTextNode(String(content));
}
function $15814c427c76c40c$export$63c5474e46577fe8(renderFunction, ...args) {
    let components = new Map(), computations = new Set();
    $15814c427c76c40c$var$renderStack.push({
        components: components,
        computations: computations
    });
    try {
        return {
            domNodes: renderFunction(...args),
            components: components,
            computations: computations
        };
    } finally{
        $15814c427c76c40c$var$renderStack.pop();
    }
}
function $15814c427c76c40c$export$77f49a256021c8de(nodes) {
    (0, $f3ad94c9f84f4d57$export$45b10814cc054894)(nodes).forEach((node)=>node.parentNode == null || node.parentNode.removeChild(node));
}
function $15814c427c76c40c$export$c1ff24e64fc53af9(nodes, pivotNode) {
    (0, $f3ad94c9f84f4d57$export$45b10814cc054894)(nodes).forEach((node)=>pivotNode.parentNode != null && node.parentNode == null && pivotNode.parentNode.insertBefore(node, pivotNode));
}
class $15814c427c76c40c$export$16fa2f45be04daa8 {
    constructor(renderFn){
        if (!renderFn) return;
        this.renderFn = renderFn.bind(this);
        this.mounted = false;
    }
    mount(pivotNode) {
        if (!this.renderFn || this.mounted) return;
        Object.assign(this, $15814c427c76c40c$export$63c5474e46577fe8(this.renderFn));
        $15814c427c76c40c$export$c1ff24e64fc53af9(this.domNodes, pivotNode);
        this.mounted = true;
    }
    mountTo(parentNode) {
        this.mount(parentNode.appendChild(document.createComment("")));
    }
    unmount() {
        if (!this.renderFn || !this.mounted) return;
        this.components.forEach((c)=>c.unmount());
        this.computations.forEach((c)=>c.stop());
        $15814c427c76c40c$export$77f49a256021c8de(this.domNodes);
        this.mounted = false;
    }
}


class $c599331589dec9f9$export$1f9ff5f4a6c9361a extends (0, $15814c427c76c40c$export$16fa2f45be04daa8) {
    constructor(condition, then, otherwise){
        super();
        this.pivotNode = null;
        this.then = new (0, $15814c427c76c40c$export$16fa2f45be04daa8)(then);
        this.otherwise = new (0, $15814c427c76c40c$export$16fa2f45be04daa8)(otherwise);
        this.computation = new (0, $5be6f8944b1012f0$export$6dda3d0957802b97)(()=>{
            if (condition()) {
                this.otherwise.unmount();
                this.then.mount(this.pivotNode);
            } else {
                this.then.unmount();
                this.otherwise.mount(this.pivotNode);
            }
        }, {
            async: true
        });
    }
    mount(pivotNode) {
        if (this.pivotNode) return;
        this.pivotNode = pivotNode;
        this.computation.run();
    }
    unmount() {
        if (!this.pivotNode) return;
        this.pivotNode = null;
        this.computation.stop();
        this.then.unmount();
        this.otherwise.unmount();
    }
}






export {$5be6f8944b1012f0$export$6dda3d0957802b97 as Computation, $c599331589dec9f9$export$1f9ff5f4a6c9361a as If, $4afa49a6779c8690$export$69fef04fa539b17a as Reactive, $15814c427c76c40c$export$16fa2f45be04daa8 as Component, $15814c427c76c40c$export$c8a8987d4410bf2d as createElement, $15814c427c76c40c$export$b2ce9ad90858ed7a as createTextNode, $15814c427c76c40c$export$c1ff24e64fc53af9 as putNodes, $15814c427c76c40c$export$77f49a256021c8de as removeNodes, $15814c427c76c40c$export$49993a8b66444073 as fillTags};
//# sourceMappingURL=lib.min.js.map
